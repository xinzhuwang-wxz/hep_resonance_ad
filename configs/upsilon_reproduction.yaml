# CATHODE dimuon anomaly detection - Upsilon 复现配置
# Phase 1: 论文复现

file_paths:
  working_dir: "."  # 相对于项目根目录
  data_storage_dir: "./data"  # 数据存储目录

analysis_keywords:
  name: "upsilon_iso_12_03"
  particle: upsilon
  dataset_id: lowmass
  
  # 分析切割
  analysis_cuts:
    lower:
      mu0_iso04: 0.55
      mu1_iso04: 0.55
      mu0_pt: 17
      mu1_pt: 8
      HLT_TrkMu15_DoubleTrkMu5NoFiltersNoVtx: 1
    upper: {}

# 窗口定义（质量范围）
window_definitions:
  upsilon:
    SB_left: 5.0
    SR_left: 9.0
    SR_right: 10.6
    SB_right: 16.0
  eta:
    SB_left: 0.3
    SR_left: 0.525
    SR_right: 0.569
    SB_right: 0.72

# 特征集合定义
feature_sets:
  # 单 muon 特征
  single_0:
    - mu0_pt
    - mu1_pt
    - mu0_eta
    - mu1_eta
    - dimu_mass
  
  single_1:
    - mu0_iso04
    - mu1_iso04
    - dimu_mass
  
  single_2:
    - mu0_pt
    - mu1_pt
    - dimu_mass
  
  single_3:
    - mu0_ip3d
    - mu1_ip3d
    - dimu_mass
  
  # Dimuon 特征
  double_0:
    - dimu_pt
    - dimu_eta
    - mumu_deltaR
    - mumu_deltapT
    - dimu_mass
  
  double_1:
    - dimu_pt
    - dimu_eta
    - dimu_mass
  
  double_2:
    - mumu_deltaR
    - mumu_deltapT
    - dimu_mass
  
  # 混合特征
  mix_0:
    - dimu_pt
    - mu0_iso04
    - mu1_iso04
    - dimu_mass
  
  mix_2:
    - dimu_pt
    - mu0_ip3d
    - mu1_ip3d
    - dimu_mass

# 数据加载配置
data:
  data_id: "skimmed_data_2016H_30555"  # 或从文件列表读取
  require_jet: false
  charge_filter: "OS"  # "OS" 或 "SS" 或 null

# 预处理配置
preprocessing:
  cushion: 0.01
  bootstrap_seed: 42

# 区域选择配置
region_selection:
  use_inner_bands: false
  num_bins_SR: 12
  binning: "linear"  # "linear" 或 "log"

# CATHODE 模型配置（Phase 1）
model:
  type: "CATHODE"
  config_file: "CATHODE_8.yml"  # 相对于 configs/ 目录
  
# 训练配置
training:
  feature_set: "mix_0"  # 使用哪个特征集合
  train_samesign: false
  batch_size: 1024
  num_epochs: 100
  learning_rate: 0.00075
  weight_decay: 0.000001
  seeds: [6, 7, 8, 9, 10]  # 多个随机种子用于稳定性测试

# 评估配置
evaluation:
  bootstrap_start: 0
  bootstrap_stop: 100
  background_fit_degree: 5  # 背景拟合的多项式阶数

# 输出配置
output:
  save_processed_data: true
  save_models: true
  save_predictions: true
  figure_format: "pdf"  # "pdf" 或 "png"

